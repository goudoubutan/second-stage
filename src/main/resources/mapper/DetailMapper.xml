<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.csqf.zx.mapper.DetailMapper">

    <resultMap type="com.csqf.zx.entity.ProductDetailEntity" id="DetailMap">
        <result property="did" column="did" jdbcType="INTEGER"/>
        <result property="pid" column="pid" jdbcType="INTEGER"/>
        <result property="dreview" column="dreview" jdbcType="VARCHAR"/>
        <result property="color" column="color" jdbcType="INTEGER"/>
        <result property="size" column="size" jdbcType="INTEGER"/>

        <association property="productEntity" javaType="com.csqf.zx.entity.ProductEntity">
            <id property="pid" column="pid"></id>

            <result property="pname" column="pname"></result>
            <result property="pinfo" column="pinfo"></result>
            <result property="pprice" column="pprice"></result>
            <result property="psrc" column="psrc"></result>
        </association>
    </resultMap>

    <!--查询单个-->
    <select id="productDetail" resultMap="DetailMap">
        select
            did, dreview, color, size, p.pname, p.pinfo, p.pprice,p.psrc
        from product p left join detail d on d.pid = p.pid
        where p.pid = #{pid}
    </select>



    <!--新增所有列-->
    <insert id="insert" keyProperty="did" useGeneratedKeys="true">
        insert into detail(pid, dreview, color, size)
        values (#{pid}, #{dreview}, #{color}, #{size})
    </insert>


    <!--通过主键修改数据-->
    <update id="update">
        update detail
        <set>
            <if test="pid != null">
                pid = #{pid},
            </if>
            <if test="dreview != null and dreview != ''">
                dreview = #{dreview},
            </if>
            <if test="color != null">
                color = #{color},
            </if>
            <if test="size != null">
                size = #{size},
            </if>
        </set>
        where did = #{did}
    </update>

    <!--通过主键删除-->
    <delete id="deleteById">
        delete from detail where did = #{did}
    </delete>

</mapper>

